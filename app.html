<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solar Editor Full</title>
<style>
body{margin:0;font-family:Inter,sans-serif;background:#121212;color:#fff;display:flex;height:100vh;overflow:hidden;}
#sidebar{width:300px;background:#1e1e1e;border-right:2px solid #222;overflow-y:auto;padding:15px;}
#workspace{flex-grow:1;background:#181818;position:relative;overflow:auto;padding:10px;}
h2{margin-bottom:10px;}
.category-title{ font-size:0.85rem;color:#aaa;text-transform:uppercase;margin:15px 0 5px; }
.block{
  background:#2b2b2b;
  border-radius:12px;
  padding:10px 14px;
  margin:6px 0;
  cursor:grab;
  font-size:14px;
  position:relative;
  display:block;
  transition:transform 0.1s, background 0.2s;
}
.block:hover{background:#3c3c3c;}
.block.event-block{background:#3c2b9f;color:#fff;}
.child-blocks{margin-left:20px;margin-top:5px;padding-left:5px;}
.block input, .block select{border-radius:4px;border:none;padding:2px 6px;margin-left:6px;background:#3c3c3c;color:#fff;}
.block input::placeholder{color:#888;}
input.text-input{width:120px;}
input.number-input{width:50px;}
button{background:#008cff;color:#fff;border:none;border-radius:6px;padding:8px 14px;cursor:pointer;margin-top:8px;font-weight:500;}
button:hover{background:#0070cc;}
.button-group{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;align-items:center;}
#exportArea{position:absolute; top:50px; left:50px; width:600px; height:350px;background:#1a1a1a; border-radius:8px; padding:10px; font-family:monospace; color:#00ff88; overflow:auto; white-space:pre; box-shadow:0 0 20px #000; display:none; cursor:move; opacity:0; transform:scale(0.8); transition:opacity 0.3s, transform 0.3s; z-index:1000;}
select{background:#3c3c3c;color:#fff;border:none;border-radius:6px;padding:6px;}
</style>
</head>
<body>
<div id="sidebar">
<h2>Solar Editor</h2>

<!-- Events -->
<div class="category">
  <div class="category-title">Starter Events</div>
  <div class="block event-block" data-lua="-- When Executed">When Executed<div class="child-blocks"></div></div>
  <div class="block event-block" data-lua="game.Players.PlayerAdded:Connect(function(player) END">When Player Joins<div class="child-blocks"></div></div>
  <div class="block event-block" data-lua="game.Players.PlayerRemoving:Connect(function(player) END">When Player Leaves<div class="child-blocks"></div></div>
  <div class="block event-block" data-lua="BUTTON_NAME.MouseButton1Click:Connect(function() END">On [Button Name] Click <input type="text" class="text-input" placeholder="ButtonName"><div class="child-blocks"></div></div>
  <div class="block event-block" data-lua="TOGGLE_NAME.MouseButton1Click:Connect(function() TOGGLE_STATE = not TOGGLE_STATE END">On [Toggle Name] Changed to [On/Off] <input type="text" class="text-input" placeholder="ToggleName"><select><option value="true">On</option><option value="false">Off</option></select><div class="child-blocks"></div></div>
</div>

<!-- Player -->
<div class="category">
  <div class="category-title">Player</div>
  <div class="block" data-lua="game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = VALUE">Set WalkSpeed <input type="number" class="number-input" placeholder="value"></div>
  <div class="block" data-lua="game.Players.LocalPlayer.Character.Humanoid.JumpPower = VALUE">Set JumpPower <input type="number" class="number-input" placeholder="value"></div>
  <div class="block" data-lua="game.Players.LocalPlayer.Character.Humanoid.Health = VALUE">Set Health <input type="number" class="number-input" placeholder="value"></div>
  <div class="block" data-lua="game.Players.LocalPlayer.Character.Humanoid.MaxHealth = VALUE">Set MaxHealth <input type="number" class="number-input" placeholder="value"></div>
  <div class="block" data-lua="game.Players.LocalPlayer.Backpack:FindFirstChild(TEXT)">Set Backpack Tool <input type="text" class="text-input" placeholder="tool name"></div>
  <div class="block" data-lua="game.Players.LocalPlayer.Character:SetPrimaryPartCFrame(CFrame.new(VALUE))">Teleport To <input type="text" class="text-input" placeholder="position"></div>
  <div class="block" data-lua="game.Players.LocalPlayer:Kick(TEXT)">Kick Player <input type="text" class="text-input" placeholder="reason"></div>
  <div class="block" data-lua="game.Players.LocalPlayer:LoadCharacter()">Respawn Player</div>
  <div class="block" data-lua="game.Workspace.CurrentCamera.CameraSubject = PLAYER.Character.Humanoid">Set Camera Target</div>
  <div class="block" data-lua="game.Workspace.CurrentCamera.FieldOfView = VALUE">Set Camera FOV <input type="number" class="number-input" placeholder="value"></div>
  <div class="block" data-lua="PLAYER.Character.HumanoidRootPart.Velocity = Vector3.new(VALUE)">Set Velocity <input type="text" class="text-input" placeholder="x,y,z"></div>
  <div class="block" data-lua="PLAYER.Character.HumanoidRootPart.CFrame = CFrame.new(VALUE)">Set CFrame <input type="text" class="text-input" placeholder="position"></div>
  <div class="block" data-lua="PLAYER.Character.Humanoid.PlatformStand = true">Sit Player</div>
  <div class="block" data-lua="PLAYER.Character.Humanoid.PlatformStand = false">Stand Player</div>
  <div class="block" data-lua="game.ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(TEXT,'All')">Send Chat <input type="text" class="text-input" placeholder="message"></div>
</div>

<!-- Workspace -->
<div class="category">
  <div class="category-title">Workspace</div>
  <div class="block" data-lua="Instance.new('Part',workspace)">Create Part <input type="text" class="text-input" placeholder="name"></div>
  <div class="block" data-lua="PART.Size = Vector3.new(VALUE)">Set Part Size <input type="text" class="text-input" placeholder="x,y,z"></div>
  <div class="block" data-lua="PART.Color = BrickColor.new(TEXT).Color">Set Part Color <input type="text" class="text-input" placeholder="color"></div>
  <div class="block" data-lua="PART.CFrame = CFrame.new(VALUE)">Move Part To <input type="text" class="text-input" placeholder="position"></div>
  <div class="block" data-lua="PART:Destroy()">Destroy Part <input type="text" class="text-input" placeholder="name"></div>
  <div class="block" data-lua="PART.Material = Enum.Material.TEXT">Set Material <input type="text" class="text-input" placeholder="material"></div>
  <div class="block" data-lua="PART.Anchored = VALUE">Set Anchored <select><option value="true">True</option><option value="false">False</option></select></div>
  <div class="block" data-lua="PART.CanCollide = VALUE">Set CanCollide <select><option value="true">True</option><option value="false">False</option></select></div>
  <div class="block" data-lua="local weld = Instance.new('Weld',PART); weld.Part0 = PART; weld.Part1 = TARGET">Weld Part <input type="text" class="text-input" placeholder="target"></div>
  <div class="block" data-lua="local mesh = Instance.new('SpecialMesh',PART); mesh.MeshType = Enum.MeshType.TEXT">Add Mesh <input type="text" class="text-input" placeholder="mesh type"></div>
  <div class="block" data-lua="PART.Velocity = Vector3.new(VALUE)">Set Velocity <input type="text" class="text-input" placeholder="x,y,z"></div>
  <div class="block" data-lua="PART.Touched:Connect(function(hit) END)">On Touch<div class="child-blocks"></div></div>
</div>

<!-- ScreenGUI -->
<div class="category">
  <div class="category-title">ScreenGUI</div>
  <div class="block" data-lua="local SCREENGUI=Instance.new('ScreenGui',game.Players.LocalPlayer.PlayerGui)">Create ScreenGui</div>
  <div class="block" data-lua="local BUTTON=Instance.new('TextButton',SCREENGUI); BUTTON.Text=TEXT">Create Button <input type="text" class="text-input" placeholder="button text"></div>
  <div class="block" data-lua="BUTTON.TextColor3 = BrickColor.new(TEXT).Color">Set Button Text Color <input type="text" class="text-input" placeholder="color"></div>
  <div class="block" data-lua="BUTTON.BackgroundColor3 = BrickColor.new(TEXT).Color">Set Button Background Color <input type="text" class="text-input" placeholder="color"></div>
  <div class="block" data-lua="BUTTON.Size = UDim2.new(VALUE)">Set Button Size <input type="text" class="text-input" placeholder="x,y"></div>
  <div class="block" data-lua="BUTTON.Position = UDim2.new(VALUE)">Set Button Position <input type="text" class="text-input" placeholder="x,y"></div>
  <div class="block" data-lua="BUTTON.MouseButton1Click:Connect(function() END)">On Button Click<div class="child-blocks"></div></div>
  <div class="block" data-lua="local TOGGLE=Instance.new('TextButton',SCREENGUI); TOGGLE.Text=TEXT">Create Toggle <input type="text" class="text-input" placeholder="toggle name"></div>
  <div class="block" data-lua="TOGGLE.MouseButton1Click:Connect(function() TOGGLE_STATE = not TOGGLE_STATE END)">On Toggle Changed<div class="child-blocks"></div></div>
  <div class="block" data-lua="local LABEL=Instance.new('TextLabel',SCREENGUI); LABEL.Text=TEXT">Create Label <input type="text" class="text-input" placeholder="label text"></div>
  <div class="block" data-lua="LABEL.TextColor3 = BrickColor.new(TEXT).Color">Set Label Color <input type="text" class="text-input" placeholder="color"></div>
</div>

<!-- Loadstring / Remote / Advanced -->
<div class="category">
  <div class="category-title">Loadstring / Advanced</div>
  <div class="block" data-lua='loadstring(game:HttpGet("URL"))()'>Loadstring from URL <input type="text" class="text-input" placeholder="https://pastebin.com/raw/..."></div>
  <div class="block" data-lua="Remote:FireServer(ARG)">Fire Remote <input type="text" class="text-input" placeholder="RemoteName"> <input type="text" class="text-input" placeholder="args"></div>
  <div class="block" data-lua="Remote.OnClientEvent:Connect(function(ARG) END)">On Remote Event <input type="text" class="text-input" placeholder="RemoteName"><div class="child-blocks"></div></div>
  <div class="block" data-lua="game:GetService('TweenService'):Create(PART,TWEENINFO,{PROPERTY=VALUE}):Play()">Tween Part <input type="text" class="text-input" placeholder="Part"></div>
  <div class="block" data-lua="game:GetService('TweenService'):Create(TEXTLABEL,TWEENINFO,{PROPERTY=VALUE}):Play()">Tween GUI <input type="text" class="text-input" placeholder="TextLabel"></div>
  <div class="block" data-lua="OBJECT:Destroy()">Destroy Object <input type="text" class="text-input" placeholder="name"></div>
  <div class="block" data-lua="OBJECT.Transparency = VALUE">Set Transparency <input type="number" class="number-input" placeholder="0-1"></div>
  <div class="block" data-lua="OBJECT.Anchored = VALUE">Set Anchored <select><option value="true">True</option><option value="false">False</option></select></div>
  <div class="block" data-lua="OBJECT.CanCollide = VALUE">Set CanCollide <select><option value="true">True</option><option value="false">False</option></select></div>
  <div class="block" data-lua="for i=1,VALUE do END">For Loop <input type="number" class="number-input" placeholder="times"><div class="child-blocks"></div></div>
  <div class="block" data-lua="while CONDITION do END">While Loop <input type="text" class="text-input" placeholder="condition"><div class="child-blocks"></div></div>
  <div class="block" data-lua="wait(VALUE)">Wait <input type="number" class="number-input" placeholder="seconds"></div>
  <div class="block" data-lua="print(TEXT)">Print <input type="text" class="text-input" placeholder="text"></div>
  <div class="block" data-lua="PLAYER.Character:SetPrimaryPartCFrame(CFrame.new(VALUE))">Teleport Player <input type="text" class="text-input" placeholder="position"></div>
</div>

<!-- Control / Logic -->
<div class="category">
  <div class="category-title">Control / Logic</div>
  <div class="block" data-lua="if CONDITION then END">If <input type="text" class="text-input" placeholder="condition"><div class="child-blocks"></div></div>
  <div class="block" data-lua="else END">Else<div class="child-blocks"></div></div>
  <div class="block" data-lua="function FUNCNAME() END">Define Function <input type="text" class="text-input" placeholder="name"><div class="child-blocks"></div></div>
  <div class="block" data-lua="FUNCNAME()">Call Function <input type="text" class="text-input" placeholder="name"></div>
  <div class="block" data-lua="repeat END until CONDITION">Repeat Loop <input type="text" class="text-input" placeholder="condition"><div class="child-blocks"></div></div>
</div>

<!-- Controls -->
<div class="button-group">
  <button id="exportBtn">Export Lua</button>
  <button id="showBtn">Show Lua</button>
  <button id="hideBtn">Hide Lua</button>
  <button id="copyBtn">Copy Lua</button>
  <button id="clearBtn">Clear Workspace</button>
  <select id="removeSelect">
    <option value="">Select Block to Remove</option>
  </select>
  <label><input type="checkbox" id="removeToggle"> Remove Selected</label>
</div>
</div>

<div id="workspace"></div>
<pre id="exportArea"></pre>

<script>
// --- Drag & snap / export logic ---
const workspace=document.getElementById("workspace");
const sidebarBlocks=document.querySelectorAll("#sidebar .block");
const exportBtn=document.getElementById("exportBtn");
const showBtn=document.getElementById("showBtn");
const hideBtn=document.getElementById("hideBtn");
const copyBtn=document.getElementById("copyBtn");
const clearBtn=document.getElementById("clearBtn");
const removeSelect=document.getElementById("removeSelect");
const removeToggle=document.getElementById("removeToggle");
const exportArea=document.getElementById("exportArea");

let dragging=null, dragClone=null, offsetX=0, offsetY=0, blockIdCounter=0;

function updateRemoveSelect(){
  removeSelect.innerHTML='<option value="">Select Block to Remove</option>';
  workspace.querySelectorAll(".block").forEach(b=>{
    removeSelect.innerHTML+='<option value="'+b.dataset.id+'">'+b.dataset.id+'</option>';
  });
}
workspace.addEventListener("DOMNodeInserted",updateRemoveSelect);
workspace.addEventListener("DOMNodeRemoved",updateRemoveSelect);

sidebarBlocks.forEach(block=>{
  block.dataset.id="block_sidebar_"+(blockIdCounter++);
  block.addEventListener("mousedown", e=>{
    if(e.target.tagName==="INPUT" || e.target.tagName==="SELECT") return;
    e.preventDefault();
    dragClone=block.cloneNode(true);
    dragClone.dataset.id="block_workspace_"+(blockIdCounter++);
    dragClone.querySelectorAll("input").forEach(inp=>inp.value="");
    dragClone.style.position="absolute";
    dragClone.style.left=e.clientX-workspace.getBoundingClientRect().left-50+"px";
    dragClone.style.top=e.clientY-workspace.getBoundingClientRect().top-20+"px";
    dragClone.style.zIndex=1000;
    workspace.appendChild(dragClone);
    dragging=dragClone;
    offsetX=e.clientX-dragClone.getBoundingClientRect().left;
    offsetY=e.clientY-dragClone.getBoundingClientRect().top;
  });
});

document.addEventListener("mousemove", e=>{
  if(dragging){
    dragging.style.left=e.clientX-workspace.getBoundingClientRect().left-offsetX+"px";
    dragging.style.top=e.clientY-workspace.getBoundingClientRect().top-offsetY+"px";
    workspace.querySelectorAll(".block").forEach(b=>{
      if(b===dragging) return;
      const rect=b.getBoundingClientRect();
      const wsRect=workspace.getBoundingClientRect();
      const snapY=rect.bottom - wsRect.top;
      if(Math.abs(snapY-(e.clientY-wsRect.top))<15){
        dragging._snapTarget=b;
      }
    });
    if(!dragging._snapTarget) dragging._snapTarget=null;
  }
});

document.addEventListener("mouseup", e=>{
  if(dragging){
    if(dragging._snapTarget){
      const parent=dragging._snapTarget.querySelector(".child-blocks");
      parent.appendChild(dragging);
      dragging.style.position="relative";
      dragging.style.left="";
      dragging.style.top="";
    }
    dragging=null;
  }
});

clearBtn.addEventListener("click",()=>{workspace.innerHTML=""; updateRemoveSelect();});
removeToggle.addEventListener("change", ()=>{
  if(removeToggle.checked && removeSelect.value){
    const b=document.querySelector('[data-id="'+removeSelect.value+'"]');
    if(b) b.remove();
    removeToggle.checked=false;
  }
});

function getNestedLua(block, indent="\t"){
  let lua=block.dataset.lua;
  block.querySelectorAll("input").forEach(inp=>{
    if(inp.type==="text") lua=lua.replace(/TEXT/g, inp.value||"");
    else if(inp.type==="number") lua=lua.replace(/VALUE/g, inp.value||0);
  });
  lua+="\n";
  const children=block.querySelector(".child-blocks");
  if(children) Array.from(children.children).forEach(c=>{
    lua+=indent+getNestedLua(c, indent+"\t").replace(/\n/g,"\n"+indent);
  });
  return lua;
}

function showExport(luaCode){
  exportArea.textContent=luaCode;
  exportArea.style.display="block";
  setTimeout(()=>{ exportArea.style.opacity="1"; exportArea.style.transform="scale(1)"; },10);
}
function hideExport(){ exportArea.style.opacity="0"; exportArea.style.transform="scale(0.8)"; setTimeout(()=>{ exportArea.style.display="none"; },300); }

exportBtn.addEventListener("click", ()=>{
  let luaCode="-- Solar Editor Generated Script\n";
  workspace.querySelectorAll(".block.event-block").forEach(b=>{ luaCode+=getNestedLua(b); });
  showExport(luaCode);
});
showBtn.addEventListener("click", ()=>{ exportArea.style.display="block"; exportArea.style.opacity="1"; exportArea.style.transform="scale(1)"; });
hideBtn.addEventListener("click", hideExport);
copyBtn.addEventListener("click", ()=>{ navigator.clipboard.writeText(exportArea.textContent).then(()=>{ alert("Lua copied!"); }); });

// Draggable exportArea
let isDraggingExport=false, dragOffsetX=0, dragOffsetY=0;
exportArea.addEventListener("mousedown", e=>{
  isDraggingExport=true;
  dragOffsetX=e.clientX-exportArea.getBoundingClientRect().left;
  dragOffsetY=e.clientY-exportArea.getBoundingClientRect().top;
});
document.addEventListener("mousemove", e=>{
  if(isDraggingExport){
    exportArea.style.left=e.clientX-dragOffsetX+"px";
    exportArea.style.top=e.clientY-dragOffsetY+"px";
  }
});
document.addEventListener("mouseup", ()=>{ isDraggingExport=false; });
</script>
</body>
</html>
